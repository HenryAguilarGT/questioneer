<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Create Questions</title>
</head>
<body>

<div class="container mt-5">
    <h2>Create Questions</h2>
    <div class="row">
        <div class="col-md-6">
            <form id="questionForm">
                <div class="form-group">
                    <label for="newQuestion">Question:</label>
                    <input type="text" class="form-control" id="newQuestion" name="question[]" required>
                </div>

                <div class="form-group">
                    <label for="newContext">Context Question:</label>
                    <input type="text" class="form-control" id="newContext" name="contextQuestion">
                </div>

                <button type="button" class="btn btn-primary mt-3" onclick="addQuestion()">Add More Questions</button>
                <button type="button" class="btn btn-success mt-3" onclick="saveQuestions()">Finish and Save</button>
            </form>
        </div>

        <div class="col-md-6">
            <div id="questionList"></div>
        </div>
    </div>
</div>

<script>
    function addQuestion() {
        const newQuestionInput = document.getElementById('newQuestion');
        const newContextInput = document.getElementById('newContext');

        const questionText = newQuestionInput.value;
        const contextQuestionText = newContextInput.value;

        if (questionText.trim() === '') {
            alert('Please enter a question before adding.');
            return;
        }

        const questionList = document.getElementById('questionList');
        const newQuestion = document.createElement('div');
        newQuestion.innerHTML = `
            <div class="mb-2">
                <span><strong>Question:</strong> ${questionText}</span>
                <div><strong>Context:</strong> ${contextQuestionText}</div>
                <button type="button" class="btn btn-warning btn-sm ml-2" onclick="editQuestion(this)">Edit</button>
                <button type="button" class="btn btn-danger btn-sm ml-2" onclick="deleteQuestion(this)">Delete</button>
            </div>
        `;
        questionList.appendChild(newQuestion);

        newQuestionInput.value = ''; // Clear the input fields
        newContextInput.value = '';
    }

    function saveQuestions() {
        const questionList = document.getElementById('questionList');
        const questionsArray = [];

        questionList.querySelectorAll('span').forEach(question => {
            const context = question.nextElementSibling.textContent.replace('Context: ', '').trim();
            questionsArray.push(`${question.textContent}\nContext: ${context}`);
        });

        const questionsText = questionsArray.join('\n');
        console.log('Questions Text:', questionsText);

        // Create a Blob containing the questions
        const blob = new Blob([questionsText], { type: 'text/plain' });

        // Create a download link
        const downloadLink = document.createElement('a');
        downloadLink.href = URL.createObjectURL(blob);
        downloadLink.download = 'questions.txt';

        // Append the link to the body
        document.body.appendChild(downloadLink);

        // Click the link programmatically
        downloadLink.click();

        // Remove the link from the DOM after a short delay
        setTimeout(() => {
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(blob);
        }, 100);
    }

    function editQuestion(button) {
        const questionDiv = button.parentNode;
        const questionText = questionDiv.querySelector('span');
        const contextQuestionText = questionDiv.querySelector('div');

        const updatedQuestion = prompt('Edit the question:', questionText.textContent);
        if (updatedQuestion !== null) {
            questionText.textContent = updatedQuestion;
            const updatedContext = prompt('Edit the context question:', contextQuestionText.textContent.replace('Context: ', '').trim());
            contextQuestionText.textContent = `Context: ${updatedContext}`;
        }
    }

    function deleteQuestion(button) {
        const questionDiv = button.parentNode;
        questionDiv.parentNode.removeChild(questionDiv);
    }
</script>

</body>
</html>
